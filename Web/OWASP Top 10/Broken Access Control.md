# Broken Acces Control
**Broken access control** allows attackers to bypass authorization which can allow them to view sensitive data or perform tasks as if they were a privileged user.

OWASP have a listed a few attack scenarios demonstrating access control weaknesses:

1. **Scenario #1**: The application uses unverified data in a SQL call that is accessing account information:
	```
	pstmt.setString(1, request.getParameter("acct"));
	ResultSet results = pstmt.executeQuery( );
	```
2. **Scenario #2**: An attacker simply force browses to target URLs. Admin rights are required for access to the admin page.

When Broken Access Control exploits or bugs are found, it will be categorised into one of two types:
- **Horizontal Privilege Escalation**: Occurs when a user can perform an action or access data of another user with the same level of permissions.
- **Vertical Privilege Escalation**: Occurs when a user can perform an action or access data of another user with a higher level of permissions.

## IDOR
### What is an IDOR vulnerability?
**IDOR** stands for Insecure Direct Object Reference and is a type of access control vulnerability. It can occur when a web server receives user-supplied input to retrieve objects (files, data, documents), and too much trust has been placed on that input data, and the web application does not validate whether the user should, in fact, have access to the requested object.

### How do I find and exploit IDOR vulnerabilities?
- **Query Component**
![[../../Media/Pasted image 20220315131433.png]]

- **Post Variables**
	```
	<form method="POST" action="/update-password">
	<input type="hidden" name="user_id" value="123">
	<div>New Password:</div>
	<div><input type="password" name="new_password"></div>
	<div><input type="submit" value="Change Password">
	</form>
	```
	
	Changing the value of this field from 123 to another user_id may result in changing the password for another user's account.

- **Cookies**
	Less experienced developers may store user information in the cookie its self, such as the user's ID. Changing the value of this cookie could result in displaying another user's information.

	```
	GET /user-information HTTP/1.1
	Host: website.thm
	Cookie: user_id=9
	User-Agent: Mozilla/5.0 (Ubuntu;Linux) Firefox/94.0
	```
	```
	GET /user-information HTTP/1.1
	Host: website.thm
	Cookie: user_id=5
	User-Agent: Mozilla/5.0 (Ubuntu;Linux) Firefox/94.0
	```

