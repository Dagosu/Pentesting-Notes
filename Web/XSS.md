# Cross-site Scripting
## XSS Explained
**Cross-site scripting** (XSS) is a security vulnerability typically found in web applications. It’s a type of injection which can allow an attacker to execute malicious scripts and have it execute on a victim’s machine.

A web application is vulnerable to XSS if it uses unsanitized user input. XSS is possible in Javascript, VBScript, Flash and CSS. There are three main types of cross-site scripting:

- **Stored XSS** - the most dangerous type of XSS. This is where a malicious string originates from the website’s database. This often happens when a website allows user input that is not sanitised (remove the "bad parts" of a users input) when inserted into the database.
- **Reflected XSS** - the malicious payload is part of the victims request to the website. The website includes this payload in response back to the user. To summarise, an attacker needs to trick a victim into clicking a URL to execute their malicious payload.
- **DOM-Based XSS** - DOM stands for **Document Object Model** and is a programming interface for HTML and XML documents. It represents the page so that programs can change the document structure, style and content. A web page is a document and this document can be either displayed in the browser window or as the HTML source.

	![](../../Media/20220316185130.png)
	
	With **DOM-Based** XSS, an attackers payload will only be executed when the vulnerable Javascript code is either loaded or interacted with. It goes through a Javascript function like so:

	```
	var keyword = document.querySelector('#search')  
	keyword.innerHTML = <script>...</script>
	```

## XSS Payloads
Some common payloads types used:
- **Popup's** `(<script>alert(“Hello World”)</script>)` - Creates a Hello World message popup on a user's browser.
- **Writing HTML** (`document.write`) - Override the website's HTML to add your own (essentially defacing the entire page).
- **XSS Keylogger** - You can log all keystrokes of a user, capturing their password and other sensitive information they type into the webpage.
- **Port scanning** - A mini local port scanner

XSS-Payloads.com ([http://www.xss-payloads.com/](http://www.xss-payloads.com/)) is a website that has XSS related Payloads, Tools, Documentation and more. 

## Protection Methods
1. **Escaping** - Escape all user input. This means any data your application has received  is secure before rendering it for your end users. By escaping user input, key characters in the data received but the web page will be prevented from being interpreter in any malicious way. For example, you could disallow the `<` and `>` characters from being rendered.  
     
2. **Validating Input** - This is the process of ensuring your application is rendering the correct data and preventing malicious data from doing harm to your site, database and users. Input validation is disallowing certain characters from being submit in the first place.  
      
3. **Sanitising** - Lastly, sanitizing data is a strong defence but should not be used to battle XSS attacks alone. Sanitizing user input is especially helpful on sites that allow HTML markup, changing the unacceptable user input into an acceptable format. For example you could sanitise the `<` character into the HTML entity `&#60;`